# =============================================================================
# Scenario 04 — Healthcare / Clinical Information System
# =============================================================================
# Domain   : Hospital-grade patient monitoring and clinical workflow platform
# Scale    : Medium (50 apps, 25 topics, 3 brokers, 8 nodes)
# Purpose  : Verify that the methodology correctly identifies SPOF nodes in
#            systems with regulatory compliance requirements, where data-loss
#            intolerance produces a PERSISTENT / RELIABLE-heavy QoS profile and
#            compliance-driven isolation creates bridge components.
#
# Topology fingerprint:
#   • Moderate connectivity but strict reliability (patient safety)
#   • Clinical data topics use PERSISTENT durability (audit trail)
#   • Few, specialized libraries shared by many apps (medical device SDK)
#   • ~25 % apps critical (vital-sign monitors, alarm gateways, EHR writers)
#   • Node topology maps to physical departments; inter-department links = bridge edges
#   • Very low subscriber fan-out: PHI data is tightly scoped
#
# Expected analysis outcomes:
#   • Alarm-gateway app emerges as articulation point bridging monitoring → EHR
#   • Topics carrying vital-sign streams rank top in betweenness centrality
#   • PERSISTENT edge weight dramatically elevates clinical-record topics
#   • Failure of any single broker affects an entire clinical department
#
# Usage:
#   python bin/generate_graph.py --config input/scenario_04_healthcare.yaml \
#          --output output/healthcare_system.json
# =============================================================================

graph:
  seed: 4004

  counts:
    nodes: 8
    applications: 50
    libraries: 12
    topics: 25
    brokers: 3

  # ---------------------------------------------------------------------------
  # NODE STATISTICS — One node per department; unequal load
  # ---------------------------------------------------------------------------
  node_stats:
    applications_per_node:
      mean: 6.25
      median: 6.0
      std: 3.0
      min: 2
      max: 14
      q1: 4.0
      q3: 9.0
      iqr: 5.0

  # ---------------------------------------------------------------------------
  # APPLICATION STATISTICS
  # ---------------------------------------------------------------------------
  application_stats:
    # Clinical apps tend to both write vitals and read orders / prescriptions
    direct_publish_count:
      mean: 2.5
      median: 2.0
      std: 1.5
      min: 0
      max: 7
      q1: 1.0
      q3: 4.0
      iqr: 3.0

    direct_subscribe_count:
      mean: 3.0
      median: 3.0
      std: 1.5
      min: 0
      max: 8
      q1: 2.0
      q3: 4.0
      iqr: 2.0

    total_publish_count_including_libraries:
      mean: 3.5
      median: 3.0
      std: 2.0
      min: 0
      max: 9
      q1: 2.0
      q3: 5.0
      iqr: 3.0

    total_subscribe_count_including_libraries:
      mean: 4.5
      median: 4.0
      std: 2.0
      min: 0
      max: 10
      q1: 3.0
      q3: 6.0
      iqr: 3.0

    # Balanced pubsub; some pure medical-device publishers and EHR consumers
    app_role_distribution:
      total_count: 50
      category_counts:
        pub: 12       # Bedside monitors, diagnostic devices (pure publishers)
        sub: 10       # EHR writers, reporting services (pure consumers)
        pubsub: 28    # Clinical gateways, alarm managers, order processors
      mode: pubsub
      mode_count: 28
      mode_percentage: 56.0

    # ~25 % critical — life-support monitoring, alarm routing, medication pump ctrl
    app_criticality_distribution:
      total_count: 50
      category_counts:
        critical: 13
        non_critical: 37
      mode: non_critical
      mode_count: 37
      mode_percentage: 74.0

  # ---------------------------------------------------------------------------
  # LIBRARY STATISTICS — Medical device SDK used by many apps
  # ---------------------------------------------------------------------------
  library_stats:
    applications_using_this_library:
      mean: 5.5
      median: 4.0
      std: 4.0
      min: 1
      max: 18
      q1: 2.0
      q3: 8.0
      iqr: 6.0

    direct_publish_count:
      mean: 1.5
      median: 1.0
      std: 1.0
      min: 0
      max: 4
      q1: 1.0
      q3: 2.0
      iqr: 1.0

    direct_subscribe_count:
      mean: 1.5
      median: 1.0
      std: 1.0
      min: 0
      max: 4
      q1: 1.0
      q3: 2.0
      iqr: 1.0

    total_publish_count_including_libraries:
      mean: 2.5
      median: 2.0
      std: 1.5
      min: 0
      max: 6
      q1: 1.0
      q3: 4.0
      iqr: 3.0

    total_subscribe_count_including_libraries:
      mean: 2.5
      median: 2.0
      std: 1.5
      min: 0
      max: 6
      q1: 1.0
      q3: 4.0
      iqr: 3.0

  # ---------------------------------------------------------------------------
  # TOPIC STATISTICS — Tightly scoped; low fan-out due to PHI constraints
  # ---------------------------------------------------------------------------
  topic_stats:
    topic_size_bytes:
      mean: 1024.0
      median: 512.0
      std: 1200.0
      min: 64
      max: 8192
      q1: 256.0
      q3: 1536.0
      iqr: 1280.0

    # Only one device publishes to a patient-specific vital-sign topic
    applications_publishing_to_this_topic:
      mean: 1.3
      median: 1.0
      std: 0.6
      min: 1
      max: 3
      q1: 1.0
      q3: 2.0
      iqr: 1.0

    # PHI constraints limit subscribers; alarm/EHR systems are the main consumers
    applications_subscribing_to_this_topic:
      mean: 2.5
      median: 2.0
      std: 1.5
      min: 1
      max: 7
      q1: 1.0
      q3: 4.0
      iqr: 3.0

  # ---------------------------------------------------------------------------
  # QOS STATISTICS — Clinical-grade: persistent + reliable everywhere it matters
  # ---------------------------------------------------------------------------
  qos_stats:
    qos_durability_distribution:
      total_count: 25
      category_counts:
        volatile: 2          # Internal heartbeats
        transient_local: 4   # Real-time waveform display (tolerable loss)
        transient: 5         # Order/prescription workflow
        persistent: 14       # Patient records, vitals, medication events
      mode: persistent
      mode_count: 14
      mode_percentage: 56.0

    qos_reliability_distribution:
      total_count: 25
      category_counts:
        best_effort: 3       # Non-critical telemetry (room temperature)
        reliable: 22         # All clinical data
      mode: reliable
      mode_count: 22
      mode_percentage: 88.0

    qos_transport_priority_distribution:
      total_count: 25
      category_counts:
        low: 2
        medium: 8
        high: 10
        critical: 5
      mode: high
      mode_count: 10
      mode_percentage: 40.0
